import{d as w,i as U,l as B,o as n,c as i,e,t as b,w as C,m as I,p as g,q as $,T as v,s as A,r as u,x as L,y as _,S as N,z as P,A as h,F as S,B as q}from"./index-45bd4f3d.js";import{a as f,_ as E}from"./Pagination.vue_vue_type_script_setup_true_lang-1261744d.js";const R={class:"list-group-item d-flex justify-content-between align-items-center"},V={class:"row align-items-center col-6"},j={class:"text-secondary"},T={class:"row col-6 col-xl-3 col-lg-4"},F={key:0,class:"col row me-2"},M=e("button",{type:"button",class:"btn btn-danger btn-admin disabled"},"管理者",-1),z=[M],D={key:1,class:"col row me-2"},O=e("button",{type:"button",class:"btn btn-secondary btn-unlock disabled"},"未上鎖",-1),G=[O],H={key:2,class:"col row me-4"},J=w({__name:"UsersList",props:{users:Array,initialUser:Object},setup(y){const p=y,s=U(()=>p.initialUser);async function r({userId:l}){const{data:c}=await f.unlockUser({userId:l});if(c.status==="error"){v.fire({icon:"error",title:"無法解鎖，請稍後再試"});return}s.value.locked=!1}return(l,c)=>{const d=B("RouterLink");return n(),i("li",R,[e("div",V,[e("h3",null,b(s.value.name),1),e("h6",j,b(s.value.email),1)]),e("div",T,[s.value.isAdmin?(n(),i("div",F,z)):s.value.locked?(n(),i("div",H,[e("button",{type:"button",class:"btn btn-success btn-lock",onClick:c[0]||(c[0]=C(m=>r({userId:s.value.userId}),["stop","prevent"]))},"解鎖")])):(n(),i("div",D,G)),I(d,{to:{name:"attendant",params:{id:s.value.userId},query:{month:"",page:1}},type:"button",class:"btn btn-primary btn-att col me-3"},{default:g(()=>[$("出勤紀錄")]),_:1},8,["to"])])])}}});const K={class:"container py-4 mt-2"},Q={class:"column mt-4"},W={class:"list-group"},X=e("p",null,"Loadind....",-1),Y={class:"d-flex justify-content-center mt-3"},te=w({__name:"AdminPage",setup(y){const p=A(),s=u([]),r=u([]),l=u(),c=u(),d=u();async function m({page:t}){try{const o=await f.getUsers({page:t});s.value=o.data.users;const a=o.data.pagination;r.value=a.pages,l.value=a.currentPage,c.value=a.prev,d.value=a.next}catch{v.fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}}const{page:k}=p.query;m({page:k}),L((t,o)=>{const{page:a}=t.query;m({page:a})});const x=async()=>{try{const{value:t}=await h.fire({title:"輸入你的資料",html:"name: <input type='text' id='swal-input1' class='swal2-input input-group-sm'>account: <input type='account' id='swal-input2' class='swal2-input'>email: <input type='email' id='swal-input3' class='swal2-input'>",focusConfirm:!1,inputAttributes:{accept:"image/*","aria-label":"Upload your profile picture"},preConfirm:()=>[document.getElementById("swal-input1").value,document.getElementById("swal-input2").value,document.getElementById("swal-input3").value]});t&&await f.addUser({name:t[0],account:t[1],email:t[2]})&&h.fire({title:"Success",text:"新增成功",icon:"success",showConfirmButton:!1,timer:1300})}catch(t){const o=t.response.data;v.fire({icon:"error",title:o.message})}};return(t,o)=>(n(),i("div",K,[e("div",{class:"column"},[e("button",{type:"button",class:"btn btn-success btn-lg",onClick:x}," 新增員工 ")]),e("div",Q,[(n(),_(N,null,{default:g(()=>[e("ul",W,[(n(!0),i(S,null,q(s.value,a=>(n(),_(J,{key:a.userId,"initial-user":a},null,8,["initial-user"]))),128))])]),fallback:g(()=>[X]),_:1})),e("div",Y,[r.value.length>1?(n(),_(E,{key:0,"current-page":l.value,"total-page":r.value,"previous-page":c.value,"next-page":d.value,routeName:"admin"},null,8,["current-page","total-page","previous-page","next-page"])):P("",!0)])])]))}});export{te as default};
