import{d as P,c as A,o as n,b as c,e,t as b,u as p,w as R,j as f,k as d,l as B,m as k,T as w,n as x,g as U,p as $,q as h,F as N,s as q,r as m,x as S,y,z as j,A as V,B as E,S as C}from"./index-570ba8af.js";const T={class:"list-group-item d-flex justify-content-between align-items-center"},z={class:"row align-items-center"},D={class:"text-secondary"},F={class:"row"},M={key:0,class:"col row me-2"},O=e("button",{type:"button",class:"btn btn-secondary me-4 disabled"},"未上鎖",-1),G=[O],H={key:1,class:"col row me-4"},J=P({__name:"UsersList",props:{users:Array,initialUser:Object},setup(t){const g=t,o=A(()=>g.initialUser);async function i({userId:u}){const{data:a}=await k.unlockUser({userId:u});if(a.status==="error"){w.fire({icon:"error",title:"無法解鎖，請稍後再試"});return}o.value.locked=!1}return(u,a)=>{const _=x("RouterLink");return n(),c("li",T,[e("div",z,[e("h3",null,b(p(o).name),1),e("h6",D,b(p(o).email),1)]),e("div",F,[p(o).locked?(n(),c("div",H,[e("button",{type:"button",class:"btn btn-success me-4",onClick:a[0]||(a[0]=R(v=>i({userId:p(o).userId}),["stop","prevent"]))},"解鎖")])):(n(),c("div",M,G)),f(_,{to:{name:"attendant",params:{id:p(o).userId},query:{month:1}},type:"button",class:"btn btn-primary col me-3"},{default:d(()=>[B("出勤紀錄")]),_:1},8,["to"])])])}}}),K={"aria-label":"Page navigation example"},Q={class:"pagination"},W=e("span",{"aria-hidden":"true"},"«",-1),X=e("span",{"aria-hidden":"true"},"»",-1),Y=P({__name:"UsersPagination",props:{currentPage:{Number,default:1},totalPage:{Array,default:[1]},previousPage:Number,nextPage:Number},setup(t){return(g,o)=>{const i=x("router-link"),u=x("RouterLink");return n(),c("nav",K,[e("ul",Q,[U(e("li",{class:h(["page-item",{disabled:t.currentPage===1}])},[f(i,{class:"page-link","aria-label":"Previous",to:{name:"admin",query:{page:t.previousPage}}},{default:d(()=>[W]),_:1},8,["to"])],2),[[$,t.previousPage]]),(n(!0),c(N,null,q(t.totalPage,a=>(n(),c("li",{key:a,class:h(["page-item",{active:t.currentPage===a}])},[f(u,{to:{name:"admin",query:{page:a}},class:"page-link"},{default:d(()=>[B(b(a),1)]),_:2},1032,["to"])],2))),128)),U(e("li",{class:h(["page-item",{disabled:t.currentPage===t.totalPage.length}])},[f(i,{class:"page-link",to:{name:"admin",query:{page:t.nextPage}},"aria-label":"Next"},{default:d(()=>[X]),_:1},8,["to"])],2),[[$,t.nextPage]])])])}}}),Z={class:"container py-4 mt-2"},ee={class:"column mt-4"},te={class:"list-group"},ae=e("p",null,"Loadind....",-1),se={class:"d-flex justify-content-center mt-3"},oe=P({__name:"AdminPage",setup(t){const g=E(),o=m([]),i=m([]),u=m(),a=m(),_=m();async function v({page:l}){try{const r=await k.getUsers({page:l}),s=r.data.pagination;o.value=r.data.users,i.value=s.pages,u.value=s.currentPage,a.value=s.prev,_.value=s.next}catch(r){console.log("error",r),w.fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}}const{page:I}=g.query;v({page:I}),S((l,r)=>{const{page:s}=l.query;v({page:s})});const L=async()=>{const{value:l}=await C.fire({title:"輸入你的資料",html:"name: <input type='text' id='swal-input1' class='swal2-input input-group-sm'>email: <input type='email' id='swal-input2' class='swal2-input'>",focusConfirm:!1,inputAttributes:{accept:"image/*","aria-label":"Upload your profile picture"},preConfirm:()=>[document.getElementById("swal-input1").value,document.getElementById("swal-input2").value]});l&&await k.addUser({name:l[0],email:l[1]}).then(r=>{r&&C.fire({title:"Success",text:"新增成功",icon:"success"})}).catch(r=>{const s=r.response.data;w.fire({icon:"error",title:s.message})})};return(l,r)=>(n(),c("div",Z,[e("div",{class:"column"},[e("button",{type:"button",class:"btn btn-success btn-lg",onClick:L}," 新增員工 ")]),e("div",ee,[(n(),y(j,null,{default:d(()=>[e("ul",te,[(n(!0),c(N,null,q(o.value,s=>(n(),y(J,{key:s.userId,"initial-user":s},null,8,["initial-user"]))),128))])]),fallback:d(()=>[ae]),_:1})),e("div",se,[i.value.length>1?(n(),y(Y,{key:0,"current-page":u.value,"total-page":i.value,"previous-page":a.value,"next-page":_.value},null,8,["current-page","total-page","previous-page","next-page"])):V("",!0)])])]))}});export{oe as default};
