import{d as $,h as R,j as w,o,c as l,e,t as x,g as p,w as j,k as h,l as m,m as L,T as P,f as U,n as C,p as b,F as N,q as S,s as T,r as g,x as V,y as k,z as E,A as M,S as d}from"./index-3a610f39.js";import{a as v}from"./admin-c5ce6d03.js";const z={class:"list-group-item d-flex justify-content-between align-items-center"},D={class:"row align-items-center"},F={class:"text-secondary"},O={class:"row"},Y={key:0,class:"col row me-2"},G=e("button",{type:"button",class:"btn btn-secondary me-4 disabled"},"未上鎖",-1),H=[G],J={key:1,class:"col row me-4"},K=$({__name:"UsersList",props:{users:Array,initialUser:Object},setup(s){const f=s,i=R(()=>f.initialUser);async function c({userId:u}){const{data:n}=await v.unlockUser({userId:u});if(n.status==="error"){P.fire({icon:"error",title:"無法解鎖，請稍後再試"});return}i.value.locked=!1}return(u,n)=>{const _=w("RouterLink");return o(),l("li",z,[e("div",D,[e("h3",null,x(p(i).name),1),e("h6",F,x(p(i).email),1)]),e("div",O,[p(i).locked?(o(),l("div",J,[e("button",{type:"button",class:"btn btn-success me-4",onClick:n[0]||(n[0]=j(y=>c({userId:p(i).userId}),["stop","prevent"]))},"解鎖")])):(o(),l("div",Y,H)),h(_,{to:{name:"attendant",params:{id:p(i).userId},query:{month:1}},type:"button",class:"btn btn-primary col me-3"},{default:m(()=>[L("出勤紀錄")]),_:1},8,["to"])])])}}}),Q={"aria-label":"Page navigation example"},W={class:"pagination"},X=e("span",{"aria-hidden":"true"},"«",-1),Z=e("span",{"aria-hidden":"true"},"»",-1),ee=$({__name:"UsersPagination",props:{currentPage:{Number,default:1},totalPage:{Array,default:[1]},previousPage:Number,nextPage:Number},setup(s){return(f,i)=>{const c=w("router-link"),u=w("RouterLink");return o(),l("nav",Q,[e("ul",W,[U(e("li",{class:b(["page-item",{disabled:s.currentPage===1}])},[h(c,{class:"page-link","aria-label":"Previous",to:{name:"admin",query:{page:s.previousPage}}},{default:m(()=>[X]),_:1},8,["to"])],2),[[C,s.previousPage]]),(o(!0),l(N,null,S(s.totalPage,n=>(o(),l("li",{key:n,class:b(["page-item",{active:s.currentPage===n}])},[h(u,{to:{name:"admin",query:{page:n}},class:"page-link"},{default:m(()=>[L(x(n),1)]),_:2},1032,["to"])],2))),128)),U(e("li",{class:b(["page-item",{disabled:s.currentPage===s.totalPage.length}])},[h(c,{class:"page-link",to:{name:"admin",query:{page:s.nextPage}},"aria-label":"Next"},{default:m(()=>[Z]),_:1},8,["to"])],2),[[C,s.nextPage]])])])}}}),te={class:"container py-4 mt-2"},ae={class:"column mt-4"},se={class:"list-group"},ne=e("p",null,"Loadind....",-1),oe={class:"d-flex justify-content-center mt-3"},ce=$({__name:"AdminPage",setup(s){const f=T(),i=g([]),c=g([]),u=g(),n=g(),_=g();async function y({page:r}){try{const a=await v.getUsers({page:r}),t=a.data.pagination;i.value=a.data.users,c.value=t.pages,u.value=t.currentPage,n.value=t.prev,_.value=t.next}catch(a){console.log("error",a),P.fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}}const{page:q}=f.query;y({page:q}),V((r,a)=>{const{page:t}=r.query;y({page:t})});const B=async()=>{const{value:r}=await d.fire({title:"輸入你的資料",html:"name: <input type='text' id='swal-input1' class='swal2-input input-group-sm'>email: <input type='email' id='swal-input2' class='swal2-input'>",focusConfirm:!1,inputAttributes:{accept:"image/*","aria-label":"Upload your profile picture"},preConfirm:()=>[document.getElementById("swal-input1").value,document.getElementById("swal-input2").value]});r&&await v.addUser({name:r[0],email:r[1]}).then(a=>{a&&d.fire({title:"Success",text:"新增成功",icon:"success"})}).catch(a=>{const t=a.response.data;P.fire({icon:"error",title:t.message})})},I=async()=>{const r=new Promise(t=>{setTimeout(()=>{t({鈦坦高雄分公司:"鈦坦高雄分公司",當前位置:"當前位置"})},1e3)}),{value:a}=await d.fire({title:"Select location",input:"radio",inputOptions:r});a&&(d.fire({html:`You selected: ${a}`}),await v.changeLocation({name:a}).then(t=>{t&&d.fire({title:"Success",text:"選擇成功",icon:"success",timer:1300})}).catch(t=>{const A=t.response.data;d.fire({icon:"error",title:A.message,timer:1300})}))};return(r,a)=>(o(),l("div",te,[e("div",{class:"column"},[e("button",{type:"button",class:"btn btn-success btn-lg",onClick:B}," 新增員工 "),e("button",{type:"button",class:"btn btn-warning btn-lg ms-3",onClick:I}," 選擇地點 ")]),e("div",ae,[(o(),k(E,null,{default:m(()=>[e("ul",se,[(o(!0),l(N,null,S(i.value,t=>(o(),k(K,{key:t.userId,"initial-user":t},null,8,["initial-user"]))),128))])]),fallback:m(()=>[ne]),_:1})),e("div",oe,[c.value.length>1?(o(),k(ee,{key:0,"current-page":u.value,"total-page":c.value,"previous-page":n.value,"next-page":_.value},null,8,["current-page","total-page","previous-page","next-page"])):M("",!0)])])]))}});export{ce as default};
