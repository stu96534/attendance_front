import{d as H,u as N,s as O,r as l,x as P,c as s,e as o,F as x,B as b,h as T,y as E,z as w,D as A,T as M,o as t,t as a,A as F}from"./index-45bd4f3d.js";import{_ as L,a as B}from"./Pagination.vue_vue_type_script_setup_true_lang-1261744d.js";const S={class:"container mt-5"},U={class:"mb-3 me-5 d-flex flex-row-reverse bd-highlight"},V=o("option",{value:""}," 全部 ",-1),j=["value"],z={class:"table text-center table-striped"},$=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"日期"),o("th",{scope:"col"},"上班時間"),o("th",{scope:"col"},"下班時間"),o("th",{scope:"col",class:"state"},"出勤狀況"),o("th",{scope:"col"},"備註")])],-1),G={key:0,scope:"row",class:"text-danger"},J={key:1,scope:"row"},K={key:2,class:"text-danger"},Q={key:3},W={key:4,class:"text-danger"},X={key:5},Y={key:6,class:"text-danger"},Z={key:7,class:"text-warning"},ee={key:8,class:"text-success"},te=["id"],se={class:"d-flex justify-content-center mt-3"},ae=H({__name:"AttendanceRecord",setup(oe){const h=N(),p=O(),I=Array.from({length:12}).map((n,c)=>c+1),R=n=>{h.push({name:"attendant",query:{month:n.target.value,page:1}})},u=l([]),_=l(),d=l([]),g=l(),m=l(),y=l();async function k({month:n,page:c}){try{const e=await B.getUserAttendant({month:n,userId:Number(p.params.id),page:c}),r=e.data.pagination;d.value=r.pages,g.value=r.currentPage,m.value=r.prev,y.value=r.next,_.value=e.data.month,u.value=e.data.attendants,u.value.map(i=>{const v=i.checkIn,f=i.checkOut;v&&(i.checkIn=A(v)),f&&(i.checkOut=A(f))})}catch(e){console.log("error",e),M.fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}}const{month:q,page:C}=p.query;k({month:q,page:C}),P((n,c)=>{const{month:e,page:r}=n.query;k({month:e,page:r})});const D=async n=>{const c=n.target.id;F.fire({title:"要改成'到勤'嗎?",showDenyButton:!0,confirmButtonText:"確定",denyButtonText:"取消"}).then(async e=>{e.isConfirmed&&(await B.changeAttendant({id:c}),h.go(0))})};return(n,c)=>(t(),s("div",S,[o("div",U,[o("select",{class:"btn btn-secondary",role:"button",id:"dropdownMenuLink",onChange:c[0]||(c[0]=e=>R(e))},[V,(t(!0),s(x,null,b(T(I),e=>(t(),s("option",{key:e,value:e},a(e)+" 月 ",9,j))),128))],32)]),o("table",z,[$,o("tbody",null,[(t(!0),s(x,null,b(u.value,e=>(t(),s("tr",{key:e.id},[e.isHoliday?(t(),s("th",G,a(e.date)+" ("+a(e.week)+")",1)):(t(),s("th",J,a(e.date)+" ("+a(e.week)+")",1)),e.isHoliday?(t(),s("td",K,a(e.checkIn),1)):(t(),s("td",Q,a(e.checkIn),1)),e.isHoliday?(t(),s("td",W,a(e.checkOut),1)):(t(),s("td",X,a(e.checkOut),1)),e.isHoliday?(t(),s("td",Y,"加班")):e.isAbsense?(t(),s("td",Z,"缺勤")):(t(),s("td",ee,"到勤")),o("td",null,[e.isAbsense?(t(),s("button",{key:0,id:e.id,class:"btn btn-sm btn-primary",onClick:D},"改為到勤",8,te)):w("",!0)])]))),128))])]),o("div",se,[d.value.length>1?(t(),E(L,{key:0,"current-page":g.value,"total-page":d.value,"previous-page":m.value,"next-page":y.value,routeName:"attendant",queryElement:{month:_.value}},null,8,["current-page","total-page","previous-page","next-page","queryElement"])):w("",!0)])]))}});export{ae as default};
