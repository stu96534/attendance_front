import{d as E,b as F,h as H,r as o,i as b,o as L,c as Y,e as s,t as u,w as q,g as A,S as D}from"./index-3a610f39.js";import{a as p}from"./attendant-4619ed0a.js";const G={class:"container py-5"},R={class:"card card-body mx-auto d-flex"},T={class:"text-center"},U=["src"],j={class:"text-center mb-4"},N={class:"h3 mb-2 mt-4 font-weight-normal fs-1"},O={class:"text-center mb-4"},V={class:"h3 mb-3 mt-1 font-weight-normal fs-5"},z={class:"text-center mb-4"},J={class:"h3 mt-1 font-weight-normal fs-1"},K={class:"d-grid justify-content-center align-self-center"},Q=["onClick","disabled"],W={class:"mt-5 mb-3 text-muted text-center"},tt=E({__name:"MainPage",setup(X){const x=F(),y=new Date().getFullYear(),l=H(()=>x.getters.currentUser),P=o(l.value.name),h=o(l.value.image),S=o(l.value.id),k=o(l.value.isDistance),_=o(""),f=o("");h.value||(h.value="https://fakeimg.pl/120x130");function v(e){let t=new Date(e),a=["日","一","二","三","四","五","六"],c=t.getFullYear(),r=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getHours()<10?"0"+t.getHours():t.getHours(),d=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),w=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),M=a[t.getDay()];_.value=i+":"+d+":"+w,f.value=c+"年"+r+"月"+n+"日 ("+M+")"}function I(){v(new Date),setInterval(function(){v(new Date)},1e3)}I();function C(e,t,a,c){const n=(a-e)*(Math.PI/180),i=(c-t)*(Math.PI/180),d=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e*(Math.PI/180))*Math.cos(a*(Math.PI/180))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))*1e3}let g,m;navigator.geolocation.watchPosition(async function(e){const{data:t}=await p.getLocation(),{latitube:a,longitube:c}=t;a===0?(g=e.coords.latitude,m=e.coords.longitude):(g=a,m=c);let r=e.coords.latitude,n=e.coords.longitude;C(r,n,g,m)<400?await b.putGPSDistance({isDistance:!0}):await b.putGPSDistance({isDistance:!1})},function(e){console.log(e)});const B=async()=>{try{const e=new Date().valueOf(),{data:t}=await p.addDate({userId:S.value,date:e});if(t.status==="error")throw new Error(t.message);D.fire({title:"Success",text:t.message,icon:"success",timer:1300})}catch{D.fire({title:"Error",text:"打卡失敗",icon:"error"})}};return(e,t)=>(L(),Y("div",G,[s("div",R,[s("div",T,[s("img",{src:h.value,class:"rounded mt-5",alt:"..."},null,8,U)]),s("div",j,[s("h1",N,u(P.value),1)]),s("div",O,[s("h1",V,u(f.value),1)]),s("div",z,[s("h1",J,u(_.value),1)]),s("div",K,[s("button",{class:"btn btn-success btn-block mb-3 fs-1 clock",type:"button",onClick:q(B,["stop","prevent"]),disabled:!k.value}," Clock ",8,Q)]),s("p",W,"© 2022-"+u(A(y)),1)])]))}});export{tt as default};
